{% extends "layout.html" %}

{% block title %}Upload History{% endblock %}

{% block content %}
<h2>Upload History</h2>
<div class="history-grid" id="historyGrid"></div>

<script>
async function loadHistory() {
  const res = await fetch('/history');
  const images = await res.json();
  const grid = document.getElementById('historyGrid');
  grid.innerHTML = '';
  images.forEach(img => {
    const div = document.createElement('div');
    div.className = 'history-item';
    div.innerHTML = `
      <img src="${img.image_url}" alt="${img.filename}">
      <p>${img.filename}</p>
      <p>${img.detections.map(d => d.crack_type + ' (' + d.confidence + '%)').join(', ')}</p>
    `;
    grid.appendChild(div);
  });
}
loadHistory();
</script>
{% endblock %}
